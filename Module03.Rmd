---
title: "Camille's R Book"
author: "Camille Fairbourn"
output: html_document
---
#Module 3 Discrete Random Variables

##Discrete Random Variables

As mentioned previously, each time you open a new RStudio session, you need to run the following three commands.

```{r message = FALSE}
require(mosaic)
require(openintro)
require(MASS)
```
####Creating a probability distribution from calculated theoretical probabilities

In the lectures we see a graph of the discrete random variable for X, the number of girls in a 3-child family

We'll use the combine function c() to create a vector of values for the random variable X and then use it again to create a vector for the probabilities.

```{r}
values<-c(0, 1, 2, 3)
probs<-c(1/8, 3/8, 3/8, 1/8)
```

Next, we'll use the barplot() function to create a barchart of the probability distribution

```{r}
barplot(probs, # Specify the vector describing the bars to plot
        names.arg = values, # Specify the vector of names to be plotted below each bar
        ylim = c(0,.4), # Specify the limits for the y-axis
        main = "3 child families", # Create a title for the chart
        ylab = "Probability", # Label the y-axis
        xlab = "Number of girls", #Label the x-axis
        col = "#D4A7B1") #Specify the color. Here I used a hexadecimal value.
```

####Creating a probability distribution from observed frequencies

Example: Restaurant Seating

Again we use the combine function, c(), to create a vector of values for the random variable X, the number of people in a restaurant party. We'll also use it to create a vector of the observed frequency for each value of X.

```{r}
values <- c(1, 2, 3, 4, 5, 6, 7)
freq <- c(25, 89, 101, 96, 58, 39, 12)
```

To calculate the probabilities, we need to divide each frequency by the total. The function sum() will calculate the total for us.

```{r}
prob <- freq / sum(freq)
```

As above, we use the barplot() function to create the graph of the *frequencies*.

```{r}
barplot(freq, # Specify the vector describing the bars to plot
        names.arg = values, # Specify the vector of names to be plotted below each bar
        main = "Restaurant Seating", # Create a title for the chart
        ylab = "Frequency", # Label the y-axis
        xlab = "Party Size", #Label the x-axis
        col = "#F3A176") #Specify the color. Here I used a hexadecimal value.
```

We can also use barplot() to create the probability graph.

```{r]}
barplot(prob, # Specify the vector describing the bars to plot
        names.arg = values, # Specify the vector of names to be plotted below each bar
        ylim = c(0,.25), # Specify the limits for the y-axis
        main = "Restaurant Seating", # Create a title for the chart
        ylab = "Probability", # Label the y-axis
        xlab = "Party Size", #Label the x-axis
        col = "#D4A7B1") #Specify the color. Here I used a hexadecimal value.
```

Notice that while the two graphs appear visually similar, in the one we are plotting frequencies and the other probabilities. This is reflected in the y-axis.

####Calculate the expected value, variance, and standard deviation of a discrete random variable

First use the combine function, c(), to enter the $x_i$ values for the random variable, and the observed frequencies for each $x_i$
```{r}
values <- c(1, 2, 3, 4, 5, 6, 7)
freq <- c(25, 89, 101, 96, 58, 39, 12)
```

Now calculate the probability $P(x_i)$ for each value.
```{r}
prob <- freq / sum(freq)
```

Calculate the sum of the product of $x_i$ and $P(x_i)$, 

$\sum x_{i}\cdot P(x_{i})$ 

and save this as ev.
```{r}
ev <- sum(values * prob)
ev
```

Next, we calculate the deviations from expected value for each $x_i$. Using mathematical notation, this is

$x_i - \mu_x$

```{r}
devs <- values - ev
```

And then square each deviation to get $(x_i - \mu_x)^2$.
```{r}
sqdevs <- (devs)^2
```

To get the variance, we multiply each deviation by the probability $P(x_i)$ and add them up.

$\sum (x_i - \mu_x)^2\cdot P(x_{i})$

```{r}
var <- sum(sqdevs * prob)
var
```

Then, to calculate the standard deviation we take the square root of the variance.
```{r}
stdev <- sqrt(var)
stdev
```

To finish off, create a table of the intermediate results we've calculated. The function cbind() combines the vectors we have created into a table.
```{r}
evvar <- cbind(values, freq, prob, devs, sqdevs)
evvar
```

##Binomial Random Variables



We can use the general expected value and variance formulas to calculate the expected value and variance of a binomial random variable.

As an example, let's assume we have a binomial random variable for a sample size of 12 and a fixed probability p = 0.12. We proceed as before, creating a vector of values $x_i$, and probabilities $P(x_i)$.

```{r}
values <- c(0:12) # This creates a vector of values from 0 to 12.
values # Check to see that the vector is correct.
probs<-dbinom(values, size = 12, prob = .12) # This calculates the binomial probabilities.
```

Calculate the expected value, $\sum x_{i}\cdot P(x_{i})$, as we did before.
```{r}
ev<-sum(values*probs)
ev
```

And repeat the steps we used above to find the variance and standard deviation.

1. Calculate the deviations from expected value for each $x_i$ to get a vector of $x_i - \mu_x$

```{r}
devs<-values-ev
```

2. Square each deviation to get $(x_i - \mu_x)^2$.

```{r}
sqdevs<-(devs)^2
```

3. Multiply each deviation by the probability $P(x_i)$ and add them up to get the variance.

$\sum (x_i - \mu_x)^2\cdot P(x_{i})$
```{r}
var<-sum(sqdevs*probs)
var
```

4. Take the square root of the variance to find the standard deviation.
```{r}
stdev<-sqrt(var)
stdev
```

It is, of course, much simpler to use the formulas:
For Expected Value:
$\mu_x = n\cdot p$

```{r}
12 * 0.12
```

For Variance:
$\sigma_x^2 = n\cdot p\cdot (1-p)$
```{r}
12 * 0.12 * (1 - 0.12)
```

For Standard Deviation: $\sigma_x = \sqrt{\sigma_x^2}$
```{r}
sqrt(12 * 0.12 * (1 - 0.12))
```

##Poisson Random Variables

#create a vector of Poisson probabilities 
#specify lambda
lam <- c(7.5)
#specify the number of probabilities you want to calculate
#make sure the number is high enough to include all of the 
#probabilities that are significantly non-zero.
values <- c(0:30)

#create the vector
probsp <- dpois(values, lam, log=FALSE)
probsp

ev <- sum(values*probsp)
ev

#calculate the deviations from expected value for each x_i
devs <- values-ev

#square each deviation
sqdevs <- (devs)^2

#multiply each deviation by the probability p(x_i) 
#and add them up to get the variance
var <- sum(sqdevs*probsp)
var

#calculate the standard deviation
stdev <- sqrt(var)
stdev

#make a barplot of the Poisson probability distribution
barplot(probsp, ylim = c(0, .17), names.arg = values, col = "#F3A176", 
        main = expression(paste("Poisson, ", lambda, "= 7.5")))